@model AIMS.Models.Requisition

@{
    ViewBag.Title = "Index";
    Layout = null;
    var imagePath = Server.MapPath("~/Content/Images");
}
<!DOCTYPE html>
<html>
<head>
    <title>@ViewBag.Title</title>
    <style>
        body {
            font-size: 15px !important;
            font-family: Calibri;
        }

        table {
            border-collapse: collapse;
        }

        .bordered-table tr td {
            margin: 300px;
            padding: 2px;
            border: 1px solid black;
            height: 0px;
        }

        .bordered-table tr th {
            font-size: 13px !important;
            border: 1px solid black;
            height: 25px;
        }

        .table-purchase-order tr td {
            margin: 5px;
            padding: 2px;
            border: 1px solid black;
            height: 22px;
        }

        .no-table-border tr td {
            margin: 5px;
            border: 1px solid white;
        }

        .item-table tr th {
            font-size: 13px !important;
            border-left: 1px solid black;
            border-bottom: 1px solid black;
            height: 20px;
        }

        .underlined-text {
            text-decoration: underline;
        }
        /*Underlined Text Added*/
        .item-table tr td {
            font-size: 12px !important;
            border-left: 1px;
            padding-left: 5px;
            border-bottom: 0px;
            height: 20px;
        }

        .item-footer tr td {
            height: 20px;
        }

        .item-table {
            border: 1px solid black;
        }

        .vat-table {
            border-top: 0px;
            border-bottom: 1px;
            border-left: 1px;
            border-right: 1px;
        }

        .information-table {
            border-top: 0px;
            border-bottom: 1px;
            border-left: 1px;
            border-right: 1px;
        }

            .information-table tr td {
                border-left: 1px;
                font-size: 12px !important;
            }

        .tabel-width {
            width: 100%;
            height: 1000px;
        }

        .font-size {
            font-size: 12px;
        }

        hr {
            border: none;
            height: 1px;
            color: #333;
            background-color: #333;
        }

        .PO {
            position: relative;
            top: -11px;
            left: 240px;
            right: 0px;
            font-size: 25px;
        }

        .tableup {
            position: relative;
            top: -60px;
            left: 0px;
            right: 0px;
        }

        .UpAgain {
            position: relative;
            top: -40px;
            left: 0px;
            right: 0px;
        }
        /*table {
            border: 1px solid black;
        }*/

    </style>
</head>
<body>
    <div class=" UpAgain">
        <img src="@imagePath\logo.jpeg" alt="mug shot" width="150px" height="150px" class="image" />

        <div class="PO">
            <strong>PURCHASE ORDER</strong>
        </div>

        <div style="padding:10px 10px; height:740px;">
            <!-- Repositioning of Date and PO number-->
            <div style=" position:relative; top: -150px; left: 525px;">
                <!--ID-->
                <table class="font-size table-purchase-order">
                    <tr>
                        <td>
                            <strong>P.O. No.</strong>
                        </td>
                        <td>
                            <span style="color:#800000"> @((Model.RequisitionId).ToString("D4")) </span><!--babaguhin -->
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <strong>P.O. Date</strong>
                        </td>
                        <td>
                            @String.Format("{0:MMMM dd, yyyy}", DateTime.Now)
                        </td>
                    </tr>
                </table>
            </div>


            <div class=" tableup">
                <div style="padding: 0px 0px 10px 0px;">
                    <!--INFORMATION-->
                    <table class="font-size bordered-table" width="100%">
                        <tr>
                            <th align="center">
                                SUPPLIER: @Model.Supplier.SupplierName.ToUpper()
                            </th>
                            <th align="center">
                                SHIP TO: ANDERSON GROUP BPO INC.
                            </th>
                        </tr>
                        <tr>
                            <td width="40%">

                                <table class="font-size no-table-border">

                                    <tr>
                                        <td width="40px">
                                            <strong>Location: </strong>
                                        </td>
                                        <td colspan="7" style="height:10px!important;">
                                            @Model.Supplier.Address
                                        </td>
                                    </tr>

                                    <tr>
                                        <td width="40px">
                                            <strong>Attention :</strong>
                                        </td>
                                        <td width="40px">
                                            @Model.Supplier.ContactPerson
                                        </td>

                                    </tr>
                                    <tr>
                                        <td><strong>Tel No.:</strong></td>
                                        <td>
                                            @Model.Supplier.ContactNo
                                        </td>
                                    </tr>

                                    <tr>
                                        <td><strong>Tax Type:</strong></td>
                                        <td>
                                            @Model.Supplier.Vatable
                                        </td>
                                    </tr>

                                    <tr>
                                        <td width="auto"><strong>Email:</strong></td>
                                        <td >
                                            <a style="height:10px;width:600px;color">   @Model.Supplier.Email</a>
                                        </td>
                                    </tr>


                                </table>
                            </td>
                            <td width="40%">
                                <!-- Changed-->
                                <table class="font-size no-table-border">
                                    <tr>
                                        <td width="650px">
                                            <strong>Location: </strong>
                                        </td>
                                        <td colspan="7" style="height:10px!important;">
                                            @Model.Location.LocationAddress
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="450px">
                                            <strong>Attention :</strong>
                                        </td>
                                        <td width="600px">
                                            Catherine Villavelez
                                        </td>

                                    </tr>
                                    <tr>
                                        <td><strong>Tel No.:</strong></td>
                                        <td width="700px">
                                            0917 5684 322
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="650px"><strong>Email:</strong></td>
                                        <td colspan="7" style="height:10px!important;">
                                            <span style="color:blue;text-decoration: underline;">catherinev@andersongroup.uk.com</span><!--babaguhin -->
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                    <table class="font-size information-table" width="100%">
                        <tr>
                            <td>
                                <strong>Requisition No.</strong>: RR-@String.Format("{0:yyy}", DateTime.Now)-@Model.RequisitionId.ToString("D4") <!--babaguhin -->
                            </td>
                            <td>
                                <strong>Required Date</strong>: @String.Format("{0:MMMM dd, yyyy}", @Model.RequiredDate)<!--babaguhin -->
                            </td>
                            <td>
                                <strong>Delivery Date</strong>: @String.Format("{0:MMMM dd, yyyy}", @Model.RequiredDate)<!--babaguhin -->
                            </td>
                            <td>
                                <strong>Pages</strong>: 1 of 1
                            </td>
                        </tr>
                    </table>
                </div>
                <div>
                    @{
                        double total = 0;
                        double totalWithVat = 0;
                        double totalPurchase = 0;
                        double totalwholdingtax = 0;
                        int counter = 0;
                    }
                    <!--ITEMS-->

                    <table class="font-size item-table" width="100%">
                        <tr>
                            <th align="center">QTY</th>
                            <th align="center">UOM</th>
                            <th align="center">ITEM DESCRIPTION</th>
                            <th align="center" style="width:20px;">UNIT PRICE</th>
                            <th align="center" style="width:20px;">TOTAL</th>
                        </tr> <!--Babaguhin-->
                        @foreach (var requisitionItem in Model.RequisitionItems)
                        {
                            if (item.isItemSelected == true)
                            {
                                <tr class="font-size">

                                    <td align="left"> @requisitionItem.Quantity</td>
                                    <td align="left">@item.UnitOfMeasurement</td>
                                    <td align="left">@item.ItemName</td>
                                    @{
                                        if (counter == 0)
                                        {
                                            <td align="right">P @item.RoundedUnitPrice </td>
                                            <td align="right">P @item.LineTotal</td>
                                        }
                                        else
                                        {
                                            <td align="right">@item.RoundedUnitPrice</td><!--Replaced alignment-->
                                            <td align="right">@item.LineTotal</td><!--Replaced alignment-->
                                        }
                                        counter++;
                                    }
                                </tr>
                            }
                            total += Double.Parse(item.LineTotal);
                        }
                    </table>
                </div>
                <!--COMPUTATION-->
                <!-- Spacing -->
                <!--            <br /> -->
                <!--            <br /> -->
                <!--            <br /> -->


                <table class="font-size" width="100%">
                    <tr class="item-footer">
                        <td width="52%">
                            <p align="justify">
                                <table style="font-size:10px;">

                                    <tr>
                                        <td>
                                            1. Please send two copies of your invoice.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            2. Enter this order in accordance with the price, terms and delivery method and specification
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            listed above.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            3. Please notify us immediately if you are unable to deliver/ship as specified.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            4. Send all the correspondence to Anderson Group BPO Inc.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            5. For clarifications on this P.O., please contact Catherine Villavelez at 4917325 /
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            (0917) 568 4322 or email andersonbpoinc.com
                                        </td>
                                    </tr>

                                </table>
                            </p>
                        </td>
                        <td width="31%">
                            @{
//if (Model.Vatable == "Vatable")
//{
//    totalWithVat = (total * .12);
//    totalPurchase = total + totalWithVat;
//}
//else
//{
//    totalPurchase = total;
//}
                            }

                            <table style="font-size:10px;">

                                <tr>
                                    <td align="left">SUB TOTAL</td>
                                </tr>

                                <tr>
                                    <td align="left" style="text-indent: 20px">DELIVERY CHARGES </td>
                                    <td align="right">
                                        P @String.Format("{0:n}", Model.DeliveryCharges)<!--babaguhin-->
                                    </td>
                                </tr>

                                <tr>
                                    <td align="left">TOTAL</td>
                                    <td align="right">
                                         @String.Format("{0:n}", (total+Model.DeliveryCharges)) <!--babaguhin-->
                                    </td>
                                </tr>

                                <tr>
                                    <td align="left">12% VAT (inclusive)</td>
                                    <td align="right">
                                         @String.Format("{0:n}", totalWithVat)<!--babaguhin-->
                                    </td>
                                </tr>
                                <tr>
                                    <td align="left">WITH HOLDING TAX <var class="underlined-text">@Model.Supplier.WholdingTax%</var></td>
                                    <td align="right">

                                        @* @String.Format("{0:n}", (totalwholdingtax = total * (Model.WholdingTax * .01)))*@
                                    </td>
                                </tr>
                                <tr>
                                    <td align="left"><strong> AMOUNT DUE</strong></td>
                                    <td align="right">
                                        <strong> P @String.Format("{0:n}", (Model.DeliveryCharges + totalPurchase - totalwholdingtax))</strong>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>

                </table>
            </div>

            <br />
            <div>
                <br />

                <!-- Spacing -->
                <!--SIGNATURE-->
                <table width="100%">
                    <tr>
                        <td>
                            <table style="font-size:11px;">
                                <tr>
                                    <td width="10px"></td>
                                    <td>
                                        <strong>Prepared by:</strong><br /><br /><br /><br />
                                        <strong class="underlined-text">CATHERINE VILLAVELEZ</strong><!--Underlined Text-->
                                    </td>
                                    <td width="100px"></td>
                                </tr>
                                <tr>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>
                                        <strong>Administrative Assistant </strong><!--Babaguhin-->
                                    </td>
                                </tr>

                            </table>
                        </td>
                        <td>
                            <table style="font-size:11px;">
                                <tr>
                                    <td width="80px"></td>
                                    <td style="padding-left: 65px;">
                                       <br /> <strong>Approved by:</strong><br /><br /><br /><br />
                                        <strong class="underlined-text">GRACE ABIGAIL C. BAGATSING</strong><!--Babaguhin-->
                                    </td>
                                    <td width="50px"></td>
                                </tr>
                                <tr>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>
                                        <div style="padding-left:93px;">
                                            <strong>Country Director</strong><!--Babaguhin-->
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</body>
</html>